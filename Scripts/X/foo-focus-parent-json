#!/usr/bin/env ruby
require 'json'


def crawl(x, parent, id)
  if (!x || x["children"] == "") then
    return
  end

  if x["children"].size != 0 then
    x["children"].each do |y|
      crawl(y, x, id)
    end
  end

  if (x["node"] == id) then
    if (parent == nil) then
      puts JSON $tree
      exit
    else
      puts JSON parent
      exit
    end
  end
end

$tree = JSON.parse(%x[foo-wm-c '/tmp/foo-wm.socket' 'get tree'])
focus = JSON.parse(%x[foo-wm-c '/tmp/foo-wm.socket' 'get focus'])["node"]
crawl($tree, nil, focus)
