#!/usr/bin/env ruby
puts ARGV[0]

if (ARGV[0] == "redo") then
  rStack = "/tmp/foo-history-a"
  oStack = "/tmp/foo-history-b"
else
  oStack = "/tmp/foo-history-a"
  rStack = "/tmp/foo-history-b"
end

run = %x[tail -n1 #{oStack}].chomp!
%x[echo #{run} >> #{rStack}]
delta = run.match(/-?[\d]+/)
newDelta = delta[0].to_i * -1
run = run.gsub(/-?[\d]+/, newDelta.to_s)
#run.gsub(/([-]\d{1})/, '\\1')
%x[foo-wm-c /tmp/foo-wm.socket "#{run}"]

%x[head -n -1 #{oStack} > #{rStack} ; mv #{rStack} #{oStack}]
